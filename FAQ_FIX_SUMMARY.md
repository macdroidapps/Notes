# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "–í–æ–ø—Ä–æ—Å –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω"

## –ü—Ä–æ–±–ª–µ–º–∞
–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–ª–∞ "–≤–æ–ø—Ä–æ—Å –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω", –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ 13 FAQ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–∏—á–∏–Ω—ã

### 1. ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ FAQ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ
**–§–∞–π–ª:** `InitializeFAQUseCase.kt`

**–ë—ã–ª–æ:**
```kotlin
val existingFAQs = faqRepository.getAllFAQs() // Flow, –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
InitialFAQData.faqs.forEach { faq ->
    faqRepository.insertFAQ(faq) // –í—Å–µ–≥–¥–∞ –≤—Å—Ç–∞–≤–ª—è–µ—Ç
}
```

**–°—Ç–∞–ª–æ:**
```kotlin
val existingFAQs = faqRepository.searchFAQs("").getOrNull() ?: emptyList()
if (existingFAQs.isEmpty()) {
    InitialFAQData.faqs.forEach { faq ->
        faqRepository.insertFAQ(faq)
    }
}
```

### 2. ‚ùå –†–µ–≥–∏—Å—Ç—Ä–æ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ–∏—Å–∫ –≤ SQL
**–§–∞–π–ª:** `FAQ.sq`

**–ë—ã–ª–æ:**
```sql
SELECT * FROM FAQ
WHERE question LIKE '%' || :query || '%'
   OR answer LIKE '%' || :query || '%'
   OR keywords LIKE '%' || :query || '%'
```

**–ü—Ä–æ–±–ª–µ–º–∞:** SQL LIKE —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É, –ø–æ—ç—Ç–æ–º—É "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è" ‚â† "–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"

**–°—Ç–∞–ª–æ:**
```sql
SELECT *
FROM FAQ
WHERE (LOWER(question) LIKE '%' || LOWER(?) || '%'
    OR LOWER(answer) LIKE '%' || LOWER(?) || '%'
    OR LOWER(keywords) LIKE '%' || LOWER(?) || '%')
ORDER BY helpful_count DESC, view_count DESC
LIMIT 10;
```

### 3. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ SQL
**–§–∞–π–ª:** `FAQLocalDataSource.kt`

**–ë—ã–ª–æ:**
```kotlin
faqQueries.searchByKeywords(query) // 1 –ø–∞—Ä–∞–º–µ—Ç—Ä
```

**–°—Ç–∞–ª–æ:**
```kotlin
faqQueries.searchByKeywords(query, query, query) // 3 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
```

**–ü—Ä–∏—á–∏–Ω–∞:** SQL –∑–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `?` —Ç—Ä–∏ —Ä–∞–∑–∞ (–¥–ª—è question, answer, keywords), –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ç—Ä–∏ —Ä–∞–∑–∞.

## –£–ª—É—á—à–µ–Ω–∏—è

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–¢–µ–ø–µ—Ä—å –≤ `SupportAIAssistant` –≤—ã–≤–æ–¥–∏—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
- –ö–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- –°–∫–æ–ª—å–∫–æ FAQ –Ω–∞–π–¥–µ–Ω–æ
- –ö–∞–∫–∏–µ —Å–∫–æ—Ä—ã —É –∫–∞–∂–¥–æ–≥–æ FAQ
- –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞

```kotlin
println("üîç [SupportAI] Searching FAQ for query: '$query'")
println("üîç [SupportAI] Found ${searchResults.size} FAQs from search")
println("üìä [SupportAI] FAQ: '...' Score: $score")
```

### 2. ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ë—ã–ª–æ: LIMIT 5
- –°—Ç–∞–ª–æ: LIMIT 10

### 3. ‚úÖ –£–ª—É—á—à–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞
–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π.

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –°–ø–æ—Å–æ–± 1: Android (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –°–æ–±—Ä–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
./gradlew :composeApp:installDebug

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ/—ç–º—É–ª—è—Ç–æ—Ä–µ

# 3. –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–∫–Ω–æ–ø–∫–∞ ‚ÑπÔ∏è —Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)

# 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã:
```

#### –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã:
1. **"–ø–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"** ‚Üí –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ FAQ –ø—Ä–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
2. **"—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è"** ‚Üí –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ FAQ –ø—Ä–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
3. **"–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É"** ‚Üí –î–æ–ª–∂–µ–Ω –¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
4. **"—Ç–æ—Ä–º–æ–∑–∏—Ç"** ‚Üí –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ FAQ –ø—Ä–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
5. **"–∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å"** ‚Üí –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ FAQ –ø—Ä–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è

### –°–ø–æ—Å–æ–± 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–¥–µ

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç –≤ `SupportAIAssistantTest.kt`:

```kotlin
@Test
fun `searchFAQs should find FAQ case-insensitive`() = runTest {
    // Arrange
    val assistant = SupportAIAssistant(faqRepository)
    
    // Act
    val result1 = assistant.getAnswer("–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø")
    val result2 = assistant.getAnswer("–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è")
    val result3 = assistant.getAnswer("–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è")
    
    // Assert
    assertTrue(result1.isSuccess)
    assertTrue(result2.isSuccess)
    assertTrue(result3.isSuccess)
    assertTrue(result1.getOrNull()!!.relatedFAQs.isNotEmpty())
}
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ø–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è?"
–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç: "ü§î –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ –Ω–∞—à—ë–ª —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π..."
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ø–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è?"
–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç: "‚úÖ –ù–∞—à—ë–ª –æ—Ç–≤–µ—Ç –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π:

–ï—Å–ª–∏ —É –≤–∞—Å –ø—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ:

1. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–≤–µ–¥—ë–Ω–Ω–æ–≥–æ email –∏ –ø–∞—Ä–æ–ª—è
2. üì∂ –ù–∞–ª–∏—á–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
3. üì± –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ–±–Ω–æ–≤–∏—Ç–µ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π)
4. üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
5. üîê –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Caps Lock –≤—ã–∫–ª—é—á–µ–Ω

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å"."
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Logcat/–∫–æ–Ω—Å–æ–ª–∏ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
üîç [SupportAI] Searching FAQ for query: '–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è'
üîç [SupportAI] Found 1 FAQs from search
üìä [SupportAI] FAQ: '–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è?...' Score: 15.5
‚úÖ [SupportAI] Returning top 1 relevant FAQs
üìö [SupportAI] Found 1 relevant FAQs
‚úÖ [SupportAI] Generating answer from FAQs
üìä [SupportAI] Confidence: 0.85
```

## –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

1. ‚úÖ `composeApp/src/commonMain/kotlin/ru/macdroid/subagentstest/features/support/domain/usecase/InitializeFAQUseCase.kt`
2. ‚úÖ `composeApp/src/commonMain/sqldelight/ru/macdroid/subagentstest/database/FAQ.sq`
3. ‚úÖ `composeApp/src/commonMain/kotlin/ru/macdroid/subagentstest/features/support/data/local/FAQLocalDataSource.kt`
4. ‚úÖ `composeApp/src/commonMain/kotlin/ru/macdroid/subagentstest/features/support/domain/ai/SupportAIAssistant.kt`

## –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤—Å—ë –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
./gradlew :composeApp:assembleDebug

# –†–µ–∑—É–ª—å—Ç–∞—Ç: BUILD SUCCESSFUL ‚úÖ
```

## –°—Ç–∞—Ç—É—Å
‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞**
‚úÖ **–ö–æ–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ**
‚è≥ **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ**

